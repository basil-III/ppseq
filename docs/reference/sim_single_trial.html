<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate a single trial with posterior probability monitoring — sim_single_trial • ppseq</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate a single trial with posterior probability monitoring — sim_single_trial" />
<meta property="og:description" content="This function is meant to be used in the context of a
clinical trial with a binary endpoint. The goal is to simulate event counts
from the binomial distribution based on the number of patients
accrued at each interim look, and calculate the posterior predictive
probability of success (or futility) at the end of a trial,
given the data available at each interim analysis." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ppseq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/zabore/ppseq">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/one_sample_expansion.html">One-sample expansion cohort</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a single trial with posterior probability monitoring</h1>
    
    <div class="hidden name"><code>sim_single_trial.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is meant to be used in the context of a
clinical trial with a binary endpoint. The goal is to simulate event counts
from the binomial distribution based on the number of patients
accrued at each interim look, and calculate the posterior predictive
probability of success (or futility) at the end of a trial,
given the data available at each interim analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>sim_single_trial</span><span class='op'>(</span>
  <span class='va'>p</span>,
  <span class='va'>n</span>,
  <span class='va'>p0</span>,
  <span class='va'>N</span>,
  direction <span class='op'>=</span> <span class='st'>"greater"</span>,
  delta <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>,
  S <span class='op'>=</span> <span class='fl'>5000</span>,
  theta <span class='op'>=</span> <span class='fl'>0.95</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>p</th>
      <td><p>vector of length two containing the probability of event in
the standard of care and experimental arm c(p0, p1) for the two-sample case;
integer of event probability for one-sample case</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>matrix containing the total number of patients accrued so far at
each interim look in the standard of care (column 1) and experimental
(column 2) arms for two-sample case; vector of sample size accrued so far
at each interim look for one-sample case. The last value should be equal to
the total sample size at the end of the trial.
If only a single look will be done
at the end of the trial, this can be a vector specifying the total sample
size c(N0, N1) for the two-sample case or an integer specifying the total
sample size N for the one-sample case.</p></td>
    </tr>
    <tr>
      <th>p0</th>
      <td><p>The target value to compare to in the one-sample case</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>the total planned sample size at the end of the trial, c(N0, N1)
for two-sample case; integer of total planned sample size at end of trial N
for one-sample case</p></td>
    </tr>
    <tr>
      <th>direction</th>
      <td><p>"greater" (default) if interest is in P(p1 &gt; p0) and "less"
if interest is in P(p1 &lt; p0) for two-sample case. For one-sample case,
"greater" if interest is in P(p &gt; p0) and "less" if interest is in P(p &lt; p0).</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>clinically meaningful difference between groups.
Typically 0 for the two-sample case. NULL for the one-sample case (default).</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>hyperparameters of prior beta distribution.
Beta(0.5, 0.5) is default</p></td>
    </tr>
    <tr>
      <th>S</th>
      <td><p>number of samples, default is 5000</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>The target posterior probability. e.g. Efficacy decision if
P(p1 &gt; p0) &gt; theta for the two-sample case with greater direction.
Default is 0.95. Can be a vector if interest is in selecting from among a
variety of thresholds.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a tibble with pp_threshold (i.e. theta, the target posterior
probability), number of responses, sample size,
posterior probability, and posterior predictive probability at each
look</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># One-sample case</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='fu'>sim_single_trial</span><span class='op'>(</span>
  p <span class='op'>=</span> <span class='fl'>0.3</span>, n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>10</span><span class='op'>)</span>, direction <span class='op'>=</span> <span class='st'>"greater"</span>,
  p0 <span class='op'>=</span> <span class='fl'>0.1</span>, delta <span class='op'>=</span> <span class='cn'>NULL</span>, prior <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>, S <span class='op'>=</span> <span class='fl'>50</span>, N <span class='op'>=</span> <span class='fl'>25</span>, theta <span class='op'>=</span> <span class='fl'>0.95</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 2 x 5</span>
#&gt;   pp_threshold    y1    n1    pp   ppp
#&gt;          <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>         0.95     1     5  0.84  0.48
#&gt; <span style='color: #BCBCBC;'>2</span>         0.95     3    10  0.98  0.84</div><div class='input'>
<span class='co'># # Two-sample case (not run)</span>
<span class='co'># set.seed(123)</span>
<span class='co'>#  sim_single_trial(</span>
<span class='co'>#    p = c(0.1, 0.3), n = cbind(c(5, 10), c(5, 10)),</span>
<span class='co'>#    direction = "greater", p0 = NULL, delta = 0, prior = c(0.5, 0.5), </span>
<span class='co'>#    S = 5000, N = c(50, 50), theta = 0.95</span>
<span class='co'>#  )</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Emily C. Zabor, Brian P. Hobbs, Michael J. Kane.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


