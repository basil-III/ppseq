<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One-sample expansion cohort • ppseq</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="One-sample expansion cohort">
<meta property="og:description" content="ppseq">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ppseq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/zabore/ppseq">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/one_sample_expansion.html">One-sample expansion cohort</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="one_sample_expansion_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="one_sample_expansion_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="one_sample_expansion_files/plotly-binding-4.9.3/plotly.js"></script><script src="one_sample_expansion_files/typedarray-0.1/typedarray.min.js"></script><script src="one_sample_expansion_files/jquery-3.5.1/jquery.min.js"></script><link href="one_sample_expansion_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="one_sample_expansion_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="one_sample_expansion_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="one_sample_expansion_files/plotly-main-1.57.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>One-sample expansion cohort</h1>
                        <h4 class="author">Emily C. Zabor</h4>
            
            <h4 class="date">Last updated: 2021-03-31</h4>
      
      
      <div class="hidden name"><code>one_sample_expansion.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The goal of this article is to provide a tutorial on the use of the <code><a href="../reference/calc_posterior.html">calc_posterior()</a></code> and <code><a href="../reference/calc_predictive.html">calc_predictive()</a></code> functions in the context of a one-sample expansion cohort. It is becoming increasingly common for expansion cohorts to be included at the end of phase I trials. An expansion cohort is a group of additional patients being treated at the recommended phase 2 dose (RP2D) that was identified in the dose finding portion of the phase I study, and is typically used to further characterize the toxicity and/or efficacy of the RP2D. Since one goal of expansion cohorts is to conserve the limited available resources for clinical studies, early stopping for futility is an important consideration. In this article we demonstrate the use of sequential posterior probability monitoring for futility in the context of a one-sample expansion cohort.</p>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>To execute the code in this tutorial, you first need to install and load the {ppseq} package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># remotes::install_github("zabore/ppseq")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ppseq</span><span class="op">)</span></code></pre></div>
</div>
<div id="trial-design" class="section level1">
<h1 class="hasAnchor">
<a href="#trial-design" class="anchor"></a>Trial design</h1>
<p>We want to plan a one-sample study. The unacceptable response rate is 0.1, and the acceptable response rate is 0.3. We plan to check for futility after every 5 patients, with a maximum sample size of 25.</p>
<div id="single-simulated-trial" class="section level2">
<h2 class="hasAnchor">
<a href="#single-simulated-trial" class="anchor"></a>Single simulated trial</h2>
<p>Let’s start by seeing what happens in a single simulated trial. We use the function <code><a href="../reference/sim_single_trial.html">sim_single_trial()</a></code> to simulate response counts based on the properties of our trial and calculate the posterior predictive value of exceeding the target posterior probability of success at each look. For simplicity, let’s say that we would stop for futility if our posterior predictive probability of exceeding the target posterior probability, which in this case is 0.95, falls below 0.1.</p>
<p>First let’s consider a trial where we achieve our acceptable response rate of 0.3.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>

<span class="va">alt1_tbl</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/sim_single_trial.html">sim_single_trial</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.3</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">50</span>, <span class="fl">5</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"greater"</span>, 
                   p <span class="op">=</span> <span class="fl">0.1</span>, delta <span class="op">=</span> <span class="cn">NULL</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>, S <span class="op">=</span> <span class="fl">5000</span>, 
                   N <span class="op">=</span> <span class="fl">50</span>, theta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#uhhygxfsno .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uhhygxfsno .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uhhygxfsno .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uhhygxfsno .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uhhygxfsno .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uhhygxfsno .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uhhygxfsno .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uhhygxfsno .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uhhygxfsno .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uhhygxfsno .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uhhygxfsno .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uhhygxfsno .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#uhhygxfsno .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uhhygxfsno .gt_from_md > :first-child {
  margin-top: 0;
}

#uhhygxfsno .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uhhygxfsno .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uhhygxfsno .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#uhhygxfsno .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uhhygxfsno .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#uhhygxfsno .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uhhygxfsno .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uhhygxfsno .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uhhygxfsno .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uhhygxfsno .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uhhygxfsno .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#uhhygxfsno .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uhhygxfsno .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#uhhygxfsno .gt_left {
  text-align: left;
}

#uhhygxfsno .gt_center {
  text-align: center;
}

#uhhygxfsno .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uhhygxfsno .gt_font_normal {
  font-weight: normal;
}

#uhhygxfsno .gt_font_bold {
  font-weight: bold;
}

#uhhygxfsno .gt_font_italic {
  font-style: italic;
}

#uhhygxfsno .gt_super {
  font-size: 65%;
}

#uhhygxfsno .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="uhhygxfsno" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pp_threshold</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">y1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ppp</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_right">5</td>
      <td class="gt_row gt_right">0.8026</td>
      <td class="gt_row gt_right">0.6126</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_right">10</td>
      <td class="gt_row gt_right">0.9664</td>
      <td class="gt_row gt_right">0.8876</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_right">15</td>
      <td class="gt_row gt_right">0.9696</td>
      <td class="gt_row gt_right">0.8854</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_right">20</td>
      <td class="gt_row gt_right">0.9994</td>
      <td class="gt_row gt_right">0.9978</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">10</td>
      <td class="gt_row gt_right">25</td>
      <td class="gt_row gt_right">1.0000</td>
      <td class="gt_row gt_right">1.0000</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">10</td>
      <td class="gt_row gt_right">30</td>
      <td class="gt_row gt_right">0.9998</td>
      <td class="gt_row gt_right">1.0000</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">11</td>
      <td class="gt_row gt_right">35</td>
      <td class="gt_row gt_right">0.9998</td>
      <td class="gt_row gt_right">1.0000</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">14</td>
      <td class="gt_row gt_right">40</td>
      <td class="gt_row gt_right">1.0000</td>
      <td class="gt_row gt_right">1.0000</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">16</td>
      <td class="gt_row gt_right">45</td>
      <td class="gt_row gt_right">1.0000</td>
      <td class="gt_row gt_right">1.0000</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">17</td>
      <td class="gt_row gt_right">50</td>
      <td class="gt_row gt_right">1.0000</td>
      <td class="gt_row gt_right">1.0000</td>
    </tr>
</tbody>
</table></div>
<p>We see here that the posterior predictive probability, in the column <code>ppp</code>, never drops below the futility level of 0.1, so we would continue enrolling in this expansion cohort until the end of the trial, where we see we have reached a 100% predictive probability of having posterior probability exceeding 0.95.</p>
<p>Now let’s consider a trial where we do not achieve our acceptable response rate of 0.3, but rather observe the unacceptable response rate of 0.1.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>

<span class="va">null1_tbl</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/sim_single_trial.html">sim_single_trial</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.1</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">50</span>, <span class="fl">5</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"greater"</span>, 
                   p <span class="op">=</span> <span class="fl">0.1</span>, delta <span class="op">=</span> <span class="cn">NULL</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>, S <span class="op">=</span> <span class="fl">5000</span>, 
                   N <span class="op">=</span> <span class="fl">50</span>, theta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#eacqfcopfr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eacqfcopfr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eacqfcopfr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eacqfcopfr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eacqfcopfr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eacqfcopfr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eacqfcopfr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eacqfcopfr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eacqfcopfr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eacqfcopfr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eacqfcopfr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eacqfcopfr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#eacqfcopfr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eacqfcopfr .gt_from_md > :first-child {
  margin-top: 0;
}

#eacqfcopfr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eacqfcopfr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eacqfcopfr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#eacqfcopfr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eacqfcopfr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#eacqfcopfr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eacqfcopfr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eacqfcopfr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eacqfcopfr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eacqfcopfr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eacqfcopfr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#eacqfcopfr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eacqfcopfr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#eacqfcopfr .gt_left {
  text-align: left;
}

#eacqfcopfr .gt_center {
  text-align: center;
}

#eacqfcopfr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eacqfcopfr .gt_font_normal {
  font-weight: normal;
}

#eacqfcopfr .gt_font_bold {
  font-weight: bold;
}

#eacqfcopfr .gt_font_italic {
  font-style: italic;
}

#eacqfcopfr .gt_super {
  font-size: 65%;
}

#eacqfcopfr .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="eacqfcopfr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pp_threshold</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">y1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ppp</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">0</td>
      <td class="gt_row gt_right">5</td>
      <td class="gt_row gt_right">0.2934</td>
      <td class="gt_row gt_right">0.1370</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_right">10</td>
      <td class="gt_row gt_right">0.5582</td>
      <td class="gt_row gt_right">0.2750</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_right">15</td>
      <td class="gt_row gt_right">0.3600</td>
      <td class="gt_row gt_right">0.0968</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_right">20</td>
      <td class="gt_row gt_right">0.5312</td>
      <td class="gt_row gt_right">0.1500</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_right">25</td>
      <td class="gt_row gt_right">0.8458</td>
      <td class="gt_row gt_right">0.4304</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_right">30</td>
      <td class="gt_row gt_right">0.7416</td>
      <td class="gt_row gt_right">0.1984</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_right">35</td>
      <td class="gt_row gt_right">0.6388</td>
      <td class="gt_row gt_right">0.0568</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_right">40</td>
      <td class="gt_row gt_right">0.7276</td>
      <td class="gt_row gt_right">0.0530</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_right">45</td>
      <td class="gt_row gt_right">0.6174</td>
      <td class="gt_row gt_right">0.0022</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_right">50</td>
      <td class="gt_row gt_right">0.5148</td>
      <td class="gt_row gt_right">0.0000</td>
    </tr>
</tbody>
</table></div>
<p>We see in this example that we drop below the futility threshold of 0.1 after enrolling 15 patients, at which point we have a posterior predictive probability of 0.0968. This would cause the trial to stop for futility to preserve resources for the investigation of more promising treatments.</p>
</div>
<div id="trial-operating-characteristics" class="section level2">
<h2 class="hasAnchor">
<a href="#trial-operating-characteristics" class="anchor"></a>Trial operating characteristics</h2>
<p>But when we are designing a trial, we want to achieve fixed operating characteristics such as type I error and power. There are several goals:</p>
<ol style="list-style-type: decimal">
<li>Determine the posterior probability threshold to declare the trial positive. For simplicity in the previous examples we used an arbitrary threshold of 0.95, but in practice we would want to calibrate this threshold to the desired design properties of our trial.</li>
<li>Determine the predictive probability threshold to stop for futility, calibrated to achieve the desired design properties of our trial.</li>
<li>Using the identified thresholds, simulate many trials to determine the average probability of stopping early for futility.</li>
<li>Consider different interim monitoring schedules</li>
</ol>
<div id="calibrating-posterior-threshold" class="section level3">
<h3 class="hasAnchor">
<a href="#calibrating-posterior-threshold" class="anchor"></a>Calibrating posterior threshold</h3>
<p>To accomplish the first goal, we simulate many trials and search over a range of thresholds to identify the threshold that achieves our desired design properties</p>
<p>The <code><a href="../reference/calibrate_posterior_threshold.html">calibrate_posterior_threshold()</a></code> function can accomplish this at the final sample size only, not considering any interim looks or early stopping.</p>
<p>We can calibrate for type I error by running this simulation in the null setting where both our target and observed response probabilities are set to 0.1. We look over a range of posterior thresholds.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>

<span class="va">thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span>, <span class="fl">0.74</span>, <span class="fl">0.78</span>, <span class="fl">0.82</span>, <span class="fl">0.86</span>, <span class="fl">0.9</span>, <span class="fl">0.92</span>, <span class="fl">0.93</span>, <span class="fl">0.94</span>, <span class="fl">0.95</span>,
                <span class="fl">0.96</span>, <span class="fl">0.97</span>, <span class="fl">0.98</span>, <span class="fl">0.99</span>, <span class="fl">0.999</span>, <span class="fl">0.9999</span>, <span class="fl">0.99999</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">post_tbl</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/calibrate_posterior_threshold.html">calibrate_posterior_threshold</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.1</span>, N <span class="op">=</span> <span class="fl">25</span>, direction <span class="op">=</span> <span class="st">"greater"</span>, 
                                p0 <span class="op">=</span> <span class="fl">0.1</span>, delta <span class="op">=</span> <span class="cn">NULL</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>, 
                                S <span class="op">=</span> <span class="fl">5000</span>, theta <span class="op">=</span> <span class="va">thresholds</span><span class="op">)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#idlkikmpdw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#idlkikmpdw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#idlkikmpdw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#idlkikmpdw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#idlkikmpdw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#idlkikmpdw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#idlkikmpdw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#idlkikmpdw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#idlkikmpdw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#idlkikmpdw .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#idlkikmpdw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#idlkikmpdw .gt_from_md > :first-child {
  margin-top: 0;
}

#idlkikmpdw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#idlkikmpdw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#idlkikmpdw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#idlkikmpdw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#idlkikmpdw .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#idlkikmpdw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#idlkikmpdw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#idlkikmpdw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#idlkikmpdw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#idlkikmpdw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#idlkikmpdw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#idlkikmpdw .gt_left {
  text-align: left;
}

#idlkikmpdw .gt_center {
  text-align: center;
}

#idlkikmpdw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#idlkikmpdw .gt_font_normal {
  font-weight: normal;
}

#idlkikmpdw .gt_font_bold {
  font-weight: bold;
}

#idlkikmpdw .gt_font_italic {
  font-style: italic;
}

#idlkikmpdw .gt_super {
  font-size: 65%;
}

#idlkikmpdw .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="idlkikmpdw" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pp_threshold</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop_pos</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">0.00000</td>
      <td class="gt_row gt_right">1.0000</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.70000</td>
      <td class="gt_row gt_right">0.2314</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.74000</td>
      <td class="gt_row gt_right">0.2314</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.78000</td>
      <td class="gt_row gt_right">0.2314</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.82000</td>
      <td class="gt_row gt_right">0.2314</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.86000</td>
      <td class="gt_row gt_right">0.0942</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.90000</td>
      <td class="gt_row gt_right">0.0942</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.92000</td>
      <td class="gt_row gt_right">0.0942</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.93000</td>
      <td class="gt_row gt_right">0.0940</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.94000</td>
      <td class="gt_row gt_right">0.0714</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.95000</td>
      <td class="gt_row gt_right">0.0308</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.96000</td>
      <td class="gt_row gt_right">0.0306</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.97000</td>
      <td class="gt_row gt_right">0.0306</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.98000</td>
      <td class="gt_row gt_right">0.0268</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.99000</td>
      <td class="gt_row gt_right">0.0102</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.99900</td>
      <td class="gt_row gt_right">0.0012</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.99990</td>
      <td class="gt_row gt_right">0.0002</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.99999</td>
      <td class="gt_row gt_right">0.0002</td>
    </tr>
<tr>
<td class="gt_row gt_right">1.00000</td>
      <td class="gt_row gt_right">0.0000</td>
    </tr>
</tbody>
</table></div>
<p>The resulting table contains the posterior probability threshold in the column <code>pp_threshold</code> and the proportion of positive trials in the column <code>prop_pos</code>. The proportion of positive trials will be the type I error in a null setting and the power in an alternative setting. In this case, we see that if we are targeting a type I error of 0.1, this falls between a threshold of 0.82 and 0.86. We can further refine our target thresholds and recalculate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>

<span class="va">thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.82</span>, <span class="fl">0.86</span>, <span class="fl">0.001</span><span class="op">)</span>

<span class="va">post_tbl</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/calibrate_posterior_threshold.html">calibrate_posterior_threshold</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.1</span>, N <span class="op">=</span> <span class="fl">25</span>, direction <span class="op">=</span> <span class="st">"greater"</span>, 
                                p0 <span class="op">=</span> <span class="fl">0.1</span>, delta <span class="op">=</span> <span class="cn">NULL</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>, 
                                S <span class="op">=</span> <span class="fl">5000</span>, theta <span class="op">=</span> <span class="va">thresholds</span><span class="op">)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#idlkikmpdw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#idlkikmpdw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#idlkikmpdw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#idlkikmpdw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#idlkikmpdw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#idlkikmpdw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#idlkikmpdw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#idlkikmpdw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#idlkikmpdw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#idlkikmpdw .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#idlkikmpdw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#idlkikmpdw .gt_from_md > :first-child {
  margin-top: 0;
}

#idlkikmpdw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#idlkikmpdw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#idlkikmpdw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#idlkikmpdw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#idlkikmpdw .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#idlkikmpdw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#idlkikmpdw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#idlkikmpdw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#idlkikmpdw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#idlkikmpdw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#idlkikmpdw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#idlkikmpdw .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#idlkikmpdw .gt_left {
  text-align: left;
}

#idlkikmpdw .gt_center {
  text-align: center;
}

#idlkikmpdw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#idlkikmpdw .gt_font_normal {
  font-weight: normal;
}

#idlkikmpdw .gt_font_bold {
  font-weight: bold;
}

#idlkikmpdw .gt_font_italic {
  font-style: italic;
}

#idlkikmpdw .gt_super {
  font-size: 65%;
}

#idlkikmpdw .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="idlkikmpdw" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pp_threshold</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop_pos</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">0.850</td>
      <td class="gt_row gt_right">0.1074</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.851</td>
      <td class="gt_row gt_right">0.1042</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.852</td>
      <td class="gt_row gt_right">0.1016</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.853</td>
      <td class="gt_row gt_right">0.0990</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.854</td>
      <td class="gt_row gt_right">0.0972</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.855</td>
      <td class="gt_row gt_right">0.0960</td>
    </tr>
</tbody>
</table></div>
<p>And we see that a threshold of 0.853 results in a type I error rate of 0.0990, just below our desired target of 0.1. (<em>Note that I have printed only a subset of the resulting table above</em>)</p>
</div>
<div id="simulataneously-calibrating-posterior-and-predictive-probabilities" class="section level3">
<h3 class="hasAnchor">
<a href="#simulataneously-calibrating-posterior-and-predictive-probabilities" class="anchor"></a>Simulataneously calibrating posterior and predictive probabilities</h3>
<p>However, what we really want in this case is to simultaneously calibrate the posterior threshold and the predictive threshold, considering the interim looks for futility. The <code><a href="../reference/calibrate_pp_ppp_threshold.html">calibrate_pp_ppp_threshold()</a></code> function can accomplish this, and will return the average sample size, the proportion of positive trials, and the proportion of trials that were stopped early for each combination of considered thresholds, thus accomplishing goals 1 through 3 above.</p>
<p>Let’s consider the null scenario where the target response probability is 0.1 and the observed response probability is also 0.1, and the alternative scenario where the observed response probability is 0.3. We generate 1000 simulated datasets. This function is written using the <code>future</code> and <code>furrr</code> packages, but the user will have to set up a call to <code><a href="https://rdrr.io/pkg/future/man/plan.html">future::plan</a></code> that is appropriate for their operating environment prior to running the function. I used the following code on a Unix server with 192 cores.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>

<span class="va">no_cores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/parallelly/man/availableCores.html">availableCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">90</span><span class="op">)</span>
<span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/future/man/multicore.html">multicore</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="va">no_cores</span><span class="op">)</span><span class="op">)</span>

<span class="va">cal_tbl</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/calibrate_pp_ppp_threshold.html">calibrate_pp_ppp_threshold</a></span><span class="op">(</span>prob_null <span class="op">=</span> <span class="fl">0.1</span>, prob_alt <span class="op">=</span> <span class="fl">0.3</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">25</span>, <span class="fl">5</span><span class="op">)</span>,
                             direction <span class="op">=</span> <span class="st">"greater"</span>, p0 <span class="op">=</span> <span class="fl">0.1</span>,
                             delta <span class="op">=</span> <span class="cn">NULL</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,
                             S <span class="op">=</span> <span class="fl">5000</span>, N <span class="op">=</span> <span class="fl">25</span>, nsim <span class="op">=</span> <span class="fl">1000</span>,
                             pp_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span>, <span class="fl">0.74</span>, <span class="fl">0.78</span>, <span class="fl">0.82</span>, <span class="fl">0.86</span>, 
                                              <span class="fl">0.9</span>, <span class="fl">0.92</span>, <span class="fl">0.93</span>, <span class="fl">0.94</span>, <span class="fl">0.95</span>, <span class="fl">0.96</span>, 
                                              <span class="fl">0.97</span>, <span class="fl">0.98</span>, <span class="fl">0.99</span>, <span class="fl">0.999</span>, <span class="fl">0.9999</span>, 
                                              <span class="fl">0.99999</span>, <span class="fl">1</span><span class="op">)</span>,
                             ppp_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fmdshubxmc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fmdshubxmc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmdshubxmc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fmdshubxmc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fmdshubxmc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmdshubxmc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmdshubxmc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fmdshubxmc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fmdshubxmc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fmdshubxmc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fmdshubxmc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fmdshubxmc .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#fmdshubxmc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fmdshubxmc .gt_from_md > :first-child {
  margin-top: 0;
}

#fmdshubxmc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fmdshubxmc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fmdshubxmc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#fmdshubxmc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmdshubxmc .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#fmdshubxmc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmdshubxmc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fmdshubxmc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fmdshubxmc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmdshubxmc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmdshubxmc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#fmdshubxmc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmdshubxmc .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#fmdshubxmc .gt_left {
  text-align: left;
}

#fmdshubxmc .gt_center {
  text-align: center;
}

#fmdshubxmc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fmdshubxmc .gt_font_normal {
  font-weight: normal;
}

#fmdshubxmc .gt_font_bold {
  font-weight: bold;
}

#fmdshubxmc .gt_font_italic {
  font-style: italic;
}

#fmdshubxmc .gt_super {
  font-size: 65%;
}

#fmdshubxmc .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="fmdshubxmc" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">pp_threshold</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ppp_threshold</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_n1_null</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop_pos_null</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop_stopped_null</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_n1_alt</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop_pos_alt</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">prop_stopped_alt</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right">0.86</td>
      <td class="gt_row gt_right">0.05</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.86</td>
      <td class="gt_row gt_right">0.10</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.86</td>
      <td class="gt_row gt_right">0.15</td>
      <td class="gt_row gt_right">11.780</td>
      <td class="gt_row gt_right">0.069</td>
      <td class="gt_row gt_right">0.791</td>
      <td class="gt_row gt_right">21.505</td>
      <td class="gt_row gt_right">0.784</td>
      <td class="gt_row gt_right">0.185</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.86</td>
      <td class="gt_row gt_right">0.20</td>
      <td class="gt_row gt_right">11.245</td>
      <td class="gt_row gt_right">0.065</td>
      <td class="gt_row gt_right">0.810</td>
      <td class="gt_row gt_right">21.350</td>
      <td class="gt_row gt_right">0.777</td>
      <td class="gt_row gt_right">0.196</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.90</td>
      <td class="gt_row gt_right">0.05</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.90</td>
      <td class="gt_row gt_right">0.10</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.90</td>
      <td class="gt_row gt_right">0.15</td>
      <td class="gt_row gt_right">11.780</td>
      <td class="gt_row gt_right">0.069</td>
      <td class="gt_row gt_right">0.791</td>
      <td class="gt_row gt_right">21.505</td>
      <td class="gt_row gt_right">0.784</td>
      <td class="gt_row gt_right">0.185</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.90</td>
      <td class="gt_row gt_right">0.20</td>
      <td class="gt_row gt_right">11.190</td>
      <td class="gt_row gt_right">0.065</td>
      <td class="gt_row gt_right">0.815</td>
      <td class="gt_row gt_right">21.245</td>
      <td class="gt_row gt_right">0.771</td>
      <td class="gt_row gt_right">0.202</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.92</td>
      <td class="gt_row gt_right">0.05</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.92</td>
      <td class="gt_row gt_right">0.10</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.92</td>
      <td class="gt_row gt_right">0.15</td>
      <td class="gt_row gt_right">11.780</td>
      <td class="gt_row gt_right">0.069</td>
      <td class="gt_row gt_right">0.791</td>
      <td class="gt_row gt_right">21.505</td>
      <td class="gt_row gt_right">0.784</td>
      <td class="gt_row gt_right">0.185</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.92</td>
      <td class="gt_row gt_right">0.20</td>
      <td class="gt_row gt_right">11.200</td>
      <td class="gt_row gt_right">0.065</td>
      <td class="gt_row gt_right">0.809</td>
      <td class="gt_row gt_right">21.280</td>
      <td class="gt_row gt_right">0.772</td>
      <td class="gt_row gt_right">0.198</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.93</td>
      <td class="gt_row gt_right">0.05</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.93</td>
      <td class="gt_row gt_right">0.10</td>
      <td class="gt_row gt_right">16.785</td>
      <td class="gt_row gt_right">0.080</td>
      <td class="gt_row gt_right">0.723</td>
      <td class="gt_row gt_right">24.345</td>
      <td class="gt_row gt_right">0.893</td>
      <td class="gt_row gt_right">0.057</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.93</td>
      <td class="gt_row gt_right">0.15</td>
      <td class="gt_row gt_right">11.780</td>
      <td class="gt_row gt_right">0.069</td>
      <td class="gt_row gt_right">0.791</td>
      <td class="gt_row gt_right">21.505</td>
      <td class="gt_row gt_right">0.784</td>
      <td class="gt_row gt_right">0.185</td>
    </tr>
<tr>
<td class="gt_row gt_right">0.93</td>
      <td class="gt_row gt_right">0.20</td>
      <td class="gt_row gt_right">11.130</td>
      <td class="gt_row gt_right">0.063</td>
      <td class="gt_row gt_right">0.814</td>
      <td class="gt_row gt_right">21.125</td>
      <td class="gt_row gt_right">0.761</td>
      <td class="gt_row gt_right">0.212</td>
    </tr>
</tbody>
</table></div>
<p>In this table we have considered 19 different posterior probability thresholds, and 4 different predictive probability thresholds, but here we only print the results that produced an acceptable type I error between 0.05 and 0.1. The column labeled <code>prop_pos_null</code> represents the type I error rate and the column labeled <code>prop_pos_alt</code> represents the power. We see that within our acceptable range of type I error, we get results with power ranging from 0.761 to 0.893. These are all fairly reasonable values of power to achieve in a type I trial.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</span>
<span class="co">#&gt; v ggplot2 3.3.3     v purrr   0.3.4</span>
<span class="co">#&gt; v tibble  3.0.6     v dplyr   1.0.4</span>
<span class="co">#&gt; v tidyr   1.1.2     v stringr 1.4.0</span>
<span class="co">#&gt; v readr   1.4.0     v forcats 0.5.1</span>
<span class="co">#&gt; -- Conflicts ------------------------------------------ tidyverse_conflicts() --</span>
<span class="co">#&gt; x dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'plotly'</span>
<span class="co">#&gt; The following object is masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     last_plot</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter</span>
<span class="co">#&gt; The following object is masked from 'package:graphics':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     layout</span>

<span class="va">plot_tbl</span> <span class="op">&lt;-</span> 
  <span class="va">cal_tbl</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">prop_pos_null</span> <span class="op">&gt;=</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="va">prop_pos_null</span> <span class="op">&lt;=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    youden <span class="op">=</span> <span class="va">prop_pos_alt</span> <span class="op">+</span> <span class="va">prop_stopped_null</span> <span class="op">-</span> <span class="fl">1</span>
  <span class="op">)</span>

<span class="va">plot_tbl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">pp_threshold</span>, <span class="va">ppp_threshold</span>, <span class="va">prop_stopped_null</span>, <span class="va">prop_pos_alt</span>, <span class="va">youden</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 16 x 5</span>
<span class="co">#&gt;    pp_threshold ppp_threshold prop_stopped_null prop_pos_alt youden</span>
<span class="co">#&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1         0.86          0.05             0.723        0.893  0.616</span>
<span class="co">#&gt;  2         0.86          0.1              0.723        0.893  0.616</span>
<span class="co">#&gt;  3         0.86          0.15             0.791        0.784  0.575</span>
<span class="co">#&gt;  4         0.86          0.2              0.81         0.777  0.587</span>
<span class="co">#&gt;  5         0.9           0.05             0.723        0.893  0.616</span>
<span class="co">#&gt;  6         0.9           0.1              0.723        0.893  0.616</span>
<span class="co">#&gt;  7         0.9           0.15             0.791        0.784  0.575</span>
<span class="co">#&gt;  8         0.9           0.2              0.815        0.771  0.586</span>
<span class="co">#&gt;  9         0.92          0.05             0.723        0.893  0.616</span>
<span class="co">#&gt; 10         0.92          0.1              0.723        0.893  0.616</span>
<span class="co">#&gt; 11         0.92          0.15             0.791        0.784  0.575</span>
<span class="co">#&gt; 12         0.92          0.2              0.809        0.772  0.581</span>
<span class="co">#&gt; 13         0.93          0.05             0.723        0.893  0.616</span>
<span class="co">#&gt; 14         0.93          0.1              0.723        0.893  0.616</span>
<span class="co">#&gt; 15         0.93          0.15             0.791        0.784  0.575</span>
<span class="co">#&gt; 16         0.93          0.2              0.814        0.761  0.575</span>

<span class="co"># Option 1: maximize specificity</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot_tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">plot_tbl</span><span class="op">$</span><span class="va">prop_stopped_null</span><span class="op">)</span>, <span class="op">]</span>, width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   pp_threshold ppp_threshold mean_n1_null prop_pos_null prop_stopped_null</span>
<span class="co">#&gt;          &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt; 1          0.9           0.2         11.2         0.065             0.815</span>
<span class="co">#&gt;   mean_n1_alt prop_pos_alt prop_stopped_alt youden</span>
<span class="co">#&gt;         &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1        21.2        0.771            0.202  0.586</span>

<span class="co"># Option 2: maximize sensitivity</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot_tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">plot_tbl</span><span class="op">$</span><span class="va">prop_pos_alt</span><span class="op">)</span>, <span class="op">]</span>, width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   pp_threshold ppp_threshold mean_n1_null prop_pos_null prop_stopped_null</span>
<span class="co">#&gt;          &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt; 1         0.86          0.05         16.8          0.08             0.723</span>
<span class="co">#&gt;   mean_n1_alt prop_pos_alt prop_stopped_alt youden</span>
<span class="co">#&gt;         &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1        24.3        0.893            0.057  0.616</span>

<span class="co"># Option 3: maximize Youden's index</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot_tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">plot_tbl</span><span class="op">$</span><span class="va">youden</span><span class="op">)</span>, <span class="op">]</span>, width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   pp_threshold ppp_threshold mean_n1_null prop_pos_null prop_stopped_null</span>
<span class="co">#&gt;          &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt; 1         0.86          0.05         16.8          0.08             0.723</span>
<span class="co">#&gt;   mean_n1_alt prop_pos_alt prop_stopped_alt youden</span>
<span class="co">#&gt;         &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1        24.3        0.893            0.057  0.616</span>

<span class="co"># Note that in this setting maximizing sensitivity and maximizing Youden's index gives the same result</span>

<span class="va">plot_tbl_dat</span> <span class="op">&lt;-</span> 
  <span class="va">plot_tbl</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    `Maximum Youden` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">youden</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">youden</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Specificity <span class="op">=</span> <span class="va">prop_stopped_null</span>, Sensitivity <span class="op">=</span> <span class="va">prop_pos_alt</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plot_tbl_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Specificity</span>, y <span class="op">=</span> <span class="va">Sensitivity</span>, 
                              color <span class="op">=</span> <span class="va">`Maximum Youden`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Proportion stopped under the null (Specificity)"</span>,
    y <span class="op">=</span> <span class="st">"Proportion positive under alternative (Sensitiivity)"</span>
  <span class="op">)</span> 

<span class="fu"><a href="https://docs.ropensci.org/plotly/reference/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-8cddf18534b9969d4497" style="width:768px;height:768px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8cddf18534b9969d4497">{"x":{"data":[{"x":[-0.791,-0.81,-0.791,-0.815,-0.791,-0.809,-0.791,-0.814],"y":[0.784,0.777,0.784,0.771,0.784,0.772,0.784,0.761],"text":["Specificity: 0.791<br />Sensitivity: 0.784<br />Maximum Youden: FALSE","Specificity: 0.810<br />Sensitivity: 0.777<br />Maximum Youden: FALSE","Specificity: 0.791<br />Sensitivity: 0.784<br />Maximum Youden: FALSE","Specificity: 0.815<br />Sensitivity: 0.771<br />Maximum Youden: FALSE","Specificity: 0.791<br />Sensitivity: 0.784<br />Maximum Youden: FALSE","Specificity: 0.809<br />Sensitivity: 0.772<br />Maximum Youden: FALSE","Specificity: 0.791<br />Sensitivity: 0.784<br />Maximum Youden: FALSE","Specificity: 0.814<br />Sensitivity: 0.761<br />Maximum Youden: FALSE"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"FALSE","legendgroup":"FALSE","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.723,-0.723,-0.723,-0.723,-0.723,-0.723,-0.723,-0.723],"y":[0.893,0.893,0.893,0.893,0.893,0.893,0.893,0.893],"text":"Specificity: 0.723<br />Sensitivity: 0.893<br />Maximum Youden:  TRUE","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"TRUE","legendgroup":"TRUE","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":37.2602739726027,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,0.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,-0.25,-0.5,-0.75,-1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Proportion stopped under the null (Specificity)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Proportion positive under alternative (Sensitiivity)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.979699803149606},"annotations":[{"text":"Maximum Youden","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4130197b3e0":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"4130197b3e0","visdat":{"4130197b3e0":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emily C. Zabor, Brian P. Hobbs, Alex Kaizer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
